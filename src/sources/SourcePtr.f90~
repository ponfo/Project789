module SourcePtrM
  use UtilitiesM
  use SourceM

  implicit none

  private
  public :: SourcePtrDT

  type :: SourcePtrDT
     class(SourceDT), pointer :: ptr
   contains
     procedure, public :: associate
     procedure, public :: evaluate
  end type SourcePtrDT

contains

  subroutine associate(this, source)
    implicit none
    class(SourcePtrDT)        , intent(inout) :: this
    type(SourceDT)    , target, intent(in)    :: source
    this%ptr => source
  end subroutine associate

  real(rkind) function evaluate(this, iFunc, val)
    implicit none
    class(SourcePtrDT)              , intent(inout) :: this
    integer(ikind)                  , intent(in)    :: iFunc
    real(rkind)       , dimension(:), intent(in)    :: val
    evaluate = this%ptr%evaluate(iFunc, val)
  end function evaluate

end module SourcePtrM
