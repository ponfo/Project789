module StructuralStrategyM

  use StructuralmodelM
  
  use SolvingStrategyM

  use DirectSchemeM
  use DirectBuilderAndSolverM
  use SchemeM
  use BuilderAndSolverM

  implicit none

  private
  public :: StructuralStrategyDT

  type, extends(NewSolvingStrategyDT) :: StructuralStrategyDT
   contains
     procedure :: useProcess  => process
     procedure :: buildStrategyAndSolve 
  end type StructuralStrategyDT

contains

  subroutine process(this)
    implicit none
    class(StructuralStrategyDT), intent(inout) :: this
  end subroutine process

  subroutine buildStrategyAndSolve(this, model)
    implicit none
    class(StructuralStrategyDT), intent(inout) :: this
    class(StructuralmodelDT)   , intent(inout) :: model
    type(DirectSchemeDT)                    :: directScheme
    type(DirectBuilderAndSolverDT)          :: directBAndS
    allocate(this%scheme, source = SetScheme(directScheme))
    allocate(this%builderAndSolver, source = SetBuilderAndSolver(directBAndS))
    call directBAndS%buildAndSolve(model)
    call DirectScheme%calculateFlux(model)
  end subroutine buildStrategyAndSolve
  
end module StructuralStrategyM
